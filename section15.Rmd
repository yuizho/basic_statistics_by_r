---
title: "section15"
output: html_document
date: "2022-12-25"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 回帰分析

- 回帰分析とは、1つあるいは複数の変数の値を用いて、ある1つの変数の値を予測するために用いられる多変量解析の一手法
- モデル
  - 予測を行う上で当てはめる計算式
  - 例でいうと `娘の身長=a＋b1×父親の身長＋b2×母親の身長＋e` がモデル
- 偏回帰係数
  - モデルの傾きとかを出すための係数かな？
  - 例でいうと、b1とb2が偏回帰係数
- 残差
  - 予測の誤差のこと
  - モデルを使った予測した値と実際の値のズレを意味する

## データの作成
```{r}
set.seed(1234)
切片 <- 102.385888
父係数 <- 0.316514
母係数 <- 0.021370
父 <- rnorm(n = 19, mean = 166.84211, sd = 5.90916)
母 <- rnorm(n = 19, mean = 155.94737, sd = 4.63649)
残差 <- rnorm(n = 19, mean = 0, sd = 2.15664)
娘 <- 切片 + 父係数 * 父 + 母係数 * 母 + 残差
重回帰データ <- cbind(娘, 父, 母)
重回帰データ
```

## Rによる分析
- 父と母の身長から娘の身長を予測することを考える
- `娘~父+母` とかくとRで表現できる
    - ~の右が説明変数で、左が目的変数になる
    - 説明変数が複数あると `重回帰分析` とよばれる
    - 重回帰分析するときは説明変数を `+` でつなぐ

```{r}
(重回帰結果) <- lm(娘 ~ 父 + 母)
# summary関数で論文などの報告で必要な値を出力
summary(重回帰結果)
```

- この結果から `娘の身長の予測値＝100.66683＋0.38064×父親の身長＋(–0.04289)×母親の身長` という重回帰式が導かれることになる

## 標準偏回帰係数
- 標準偏回帰係数を出すと説明変数の影響力の強さを表せる
  - https://www.youtube.com/watch?v=20S93xDxSZ0
- 偏回帰係数はデータの単位とかに依存して変わってしまうので、説明変数の影響力の強さは表せない
- 標準偏回帰係数は標準化された偏回帰係数みたいなことなので、説明変数の影響力の強さを表せる

```{r}
coef(重回帰結果)[2:3] * sd(重回帰データ[, 2:3] / sd(重回帰データ[, 1]))
```