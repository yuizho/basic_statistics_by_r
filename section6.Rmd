---
title: "section6.Rmd"
output: html_document
date: "2022-12-17"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# ２つの平均値を比較する
- 独立な二郡に対して差があるかを検討したいケースがある
    - 独立した二郡に対してt検定を実施でくｒ

```{r}
統計1男 <- c(6, 10, 6, 10, 5, 3, 5, 9, 3, 3)
統計1男
統計1女 <- c(11, 6, 11, 9, 7, 5, 8, 7, 7, 9)
統計1女

t.test(統計1男, 統計1女, var.equal = TRUE)
```

- 帰無仮説: ２つの母平均は等しい
- 対立仮設: ２つの母平均は等しくない
- 上記のケースではt検定の前提条件のチェックがなされていない

## t検定の前提条件

- t検定の前提条件
  - 標本が無作為に抽出されていること
  - 母集団の分布が正規分布に従っていること
  - 2つの母集団の分散が等質であること

```{r}
classA <- c(54, 55, 52, 48, 50, 38, 41, 40, 53, 52)
classB <- c(67, 63, 50, 60, 61, 69, 43, 58, 36, 29)
t.test(classA, classB, var.equal = TRUE)
```

- 分散の等質性の検定
  - var.testで検定できる
  - p値が0.05以下であれば、帰無仮説が棄却され、分散の等質性の仮定は満たされないことになる
- 分散の等質性の仮定は満たされない場合にはT検定の代わりにWelchの検定が使える

## Welchiの検定
- t.test関数でvar.equal=FALSEのオプション(もしくはオプションを省略)をつけるとWelchの検定が行われる

```{r}
t.test(classA, classB, var.equal = FALSE)
```

## 対応のあるt検定
- 無造作でなく、恣意的にある母集団から郡を作った場合、これらの郡を対応のあるデータと呼ぶ
-  対応のあるデータの場合は、独立な2郡のt検定とは別の方法を取る必要がある

```{r}
統計テスト1 <- c(6, 10, 6, 10, 5, 3, 5, 9, 3, 3, 11, 6, 11, 9, 7, 5, 8, 7, 7, 9)
統計テスト2 <- c(10, 13, 8, 15, 8, 6, 9, 10, 7, 3, 18, 14, 18, 11, 12, 5, 7, 12, 7, 7)
t.test(統計テスト1, 統計テスト2, paired = TRUE)
```

- t.test関数にpaired=TRUEのオプションを増やすと、対応のありの場合でも、変化量を考慮していい感じにT検定してくれる