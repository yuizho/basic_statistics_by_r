---
title: "section4.Rmd"
output: html_document
date: "2022-11-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 推測統計

- 推測統計では非常に大規模なデータ全体の統計的性質について、その対象の一部を取り出したデータから全体を推測する
- 莫大なデータに関してすべて性格に調べることはコストが掛かりすぎるので、ある程度の正確さは犠牲にして、一部のデータのみを対象にするものである
- データ全体を母集団、一部のデータを標本という

## 推測統計の分類

- 推定
  - 具体的な値を用いて母数の値はこれくらいかなーという結論を導くもの
  - 推定の種類
    - 点推定
      - 「日本の中学生全体のテストの平均点は60点だろう」のように一つの値で推定の結果を表すものを点推定という
    - 区間推定
      - 「日本の中学生全体のテストの平均点は50~70点だろう」のようにある程度幅を持った区間で結果を表すのが区間推定という
- 検定
  - 母集団について述べた２つの主張(仮設)のうちどちらを採択するか決めるためのもの
  - 「日本の中学生全体のテストの平均的な学力は5年前から変化していない」と「日本の中学生全体のテストの平均的な学力は5年前から変化した」という２つの仮説のうち、標本を使ってどちらを採択するのか決めるのが検定


## 点推定

```{r}
身長 <- c(165.2, 175.9, 161.7, 174.2, 172.1, 163.3, 170.9, 170.6, 168.4, 171.3)
mean(身長)
```

- 平均をとることは
  - 記述統計の文脈では数値を要約するための代表値を求めること
  - 推測統計の文脈では、母平均の点推定を行うこと
    - 標本平均、不偏分散などなど
    
## 推定がどれくらいになるのか調べる方法

### 確率分布
```{r}
サイコロ6 <- ceiling(runif(n=6, min=0, max=6))
table(サイコロ6)

サイコロ600万 <- ceiling(runif(n=6000000, min=0, max=6))
table(サイコロ600万)
```

- 確率分布とはある確率変数(結果が得られるまで何が出るかわからない変数)がどのような値をどのような確率で取るか表した分布
  - 「確率変数Xは確率分布Aに従う」みたいな言い方をしたりする
- 理論値なので現実の結果がピタリ確率分布に従うことはない
  - ただし試行回数を多くすると確率分布に近づく

### 正規分布

```{r}
curve(dnorm(x, mean=0, sd=1), from=-4, to=4)
```

- 統計学の理論で最もよく使われる確率分布
- 左右対称の釣鐘型の分布で、実世界でもしばしば見られる分布である
- curve
  - 曲線グラフを書く
  - curve(xを含んだ関数, from=左端の値, to=右端の値)
- dnorm
  - 正規分布の確率密度関数(曲線を表す数式)
  - donrm(確率変数の値, 平均, 標準偏差)
    - 確率変数の値を指定しない場合具体的な範囲はもとまれない感じ？
- 平均=1, 分散=1の正規分布を標準正規分布という


### 正規分布に従う母集団から無造作抽出する

```{r}
標本 <- rnorm(n=5, mean=50, sd=10)
hist(標本)

大標本 <- rnorm(n=10000, mean=50, sd=10)
hist(大標本)
```


- rnormで正規分布に従う母集団から無造作抽出できる
- 標本数を大きくするとかなり正規分布に近いヒストグラムが描ける

## 標本分布

```{r}
標本 <- rnorm(n=10, mean=50, sd=10)
標本
mean(標本)

# 10000回標本平均を計算して格納する
標本平均 <- numeric(length = 10000)
for (i in 1:10000) {
  標本 <- rnorm(n=10, mean=50, sd=10)
  標本平均[i] <- mean(標本)
}
# freq=FALSEで縦軸を度数ではなくて、確率分布と同じ単位で表すものになる
hist(標本平均, freq=FALSE)
curve(dnorm(x, mean=50, sd=sqrt(10)), add=TRUE)
```

- 標本統計量 (標本平均、標本分散など)の確率分布のこと
- ある正規分布に従うと思うわれる母集団から無作為標本抽出を繰り返し行う
  - 数回だとブレが大きいがこれを10000回も繰り返すとほぼ正規分布と同様なヒストグラムになる
  - 母集団分布が正規分布でなくても、nが大きいとほぼ正規分布になる。これが中央極限定理。