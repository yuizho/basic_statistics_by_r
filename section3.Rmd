---
title: "section3"
output: html_document
date: "2022-11-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 散布図

```{r}
統計テスト1 <- c(6, 10, 6, 10, 5, 3, 5, 9, 3, 3, 11, 6, 11, 9, 7, 5, 8, 7, 7, 9)
統計テスト2 <- c(10, 13, 8, 15, 8, 6, 9, 10, 7, 3, 18, 14, 18, 11, 12, 5, 7, 12, 7, 7)
plot(統計テスト1, 統計テスト2)
```

- 2つ変数の関係例えば、心理学テストの得点と統計テストの得点の傾向等、量的変数同士の関係を相関という

```{r}
心理学テスト <- c(13, 14, 7, 12, 10, 6, 8, 15, 4, 14, 9, 6, 10, 12, 5, 12, 5, 12, 8, 8)
plot(心理学テスト, 統計テスト1)
```

- これら２つの変数の相関は弱いので、散布図は全体的に散らばっている

## 共分散

```{r}
共分散1と2 <- sum((統計テスト1-mean(統計テスト1))*(統計テスト2-mean(統計テスト2)))/length(統計テスト1)
共分散1と2

# cov関数でも同様の結果になる
# ただし n ではなく n-1 で割る(不偏共分散)ので結果は異なる
cov(統計テスト1, 統計テスト2)
```

-変数がたくさんある場合散布図だけだといっぱい散布図書かないと行けなくてたいへん
- 相関の強さはこれくらいだよーというのを、相関係数として示すことが一般的
- 相関係数と同様に、共分散も２つの変数の関係の強さを表す指標
- 共分散とは偏差(平均からの距離)の関の平均
  - 大きさが測定単位に依存してしまうのが弱点
  
## 相関係数
```{r}
cov(統計テスト1, 統計テスト2)/(sd(統計テスト1)*sd(統計テスト2)) 
cor(統計テスト1, 統計テスト2)

cor(心理学テスト, 統計テスト1)
```


- 共分散を2変数の標準偏差の積で割ると、単位に依存しない相関係数になるぞ！
- 0.7以上、-0.7未満で強い相関ありとみなせるよ
  - ただし、研究分野などで相関係数の値の評価が異なる場合もあるよ
  
## クロス集計表 (連関)

```{r}
数学 <- c("嫌い", "嫌い", "好き", "好き", "嫌い", "嫌い", "嫌い", "嫌い", "嫌い", "好き", "好き", "嫌い", "好き", "嫌い", "嫌い", "好き", "嫌い", "嫌い", "嫌い", "嫌い")
table(数学)

統計 <- c("好き", "好き", "好き", "好き", "嫌い", "嫌い", "嫌い", "嫌い", "嫌い", "嫌い", "好き", "好き", "好き", "嫌い", "好き", "嫌い", "嫌い", "嫌い", "嫌い", "嫌い")
table(統計)

# クロス集計表
table(数学, 統計)
```

- 洋食派か和食派か、甘党か辛党かのように質的変数(カテゴリカル変数)の関係を連関という
- 連関を視覚的に表す方法として、クロス集計表がある
  - これを指標として表す場合は後述するファイ係数を使用する

# ファイ係数

```{r}
数学イチゼロ <- ifelse(数学=="好き", 1, 0)
数学イチゼロ
統計イチゼロ <- ifelse(統計=="好き", 1, 0)
統計イチゼロ

# ファイ係数 (1 or 0からなる相関係数)
cor(数学イチゼロ, 統計イチゼロ)
```
``

- ファイ係数とは相関係数の1と0の２つからなる変数(二項目変数)に対して計算される版 (つまり相関係数の親戚みたいなもんね)
- 論文やレポートには散布図を軽足する代わりに相関係数を提示することが多いけど、ファイ係数の場合はクロス集計表と合わせて提示するのがよいよ
